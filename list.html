<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://monolis.f5.si/js/api_access.js"></script>
<link rel="stylesheet" href="list.css">
<title>MONOLIS</title>



</head>
<body>
<h1>ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§</h1>
<ul id="fileList">

</ul>
<button id="addFileButton">ï¼‹ æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ </button>

<!--ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å‰Šé™¤-->
<div class="deleteUser">
  <p id="deleteUser">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å‰Šé™¤ã‚’è¡Œã†</p>
</div>

<script>
  const api = new MonolisAPI("monolis.f5.si/api");
  const deleteUser = document.getElementById('deleteUser');
  
            
  deleteUser.addEventListener('click', async () => {
    const confirmed = confirm('æœ¬å½“ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ');
    if (confirmed) { 
    try {
        const res = await api.logout();

        if (res.status === 200) {
                        // æˆåŠŸã®å‡¦ç†
                        alert('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚');
                        window.location.href = 'top.html';
                    } else if (res.status === 404) {
                        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã®å‡¦ç†
                        alert('ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
                    } else {
                        // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†
                        alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
                    }
                } catch (error) {
                    // é€šä¿¡ã‚¨ãƒ©ãƒ¼ã®å‡¦ç†
                    alert('é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
                    console.error(error);
                }
}});
</script>


<!--ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã®æ“ä½œ-->
<div class="logout">
  <button id="logoutButton">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
</div>

<script>
  const logoutButton = document.getElementById('logoutButton');

  logoutButton.addEventListener('click', async () => {
      try {
          const res = await api.logout();

          if (res.status === 200) {
              // æˆåŠŸã®å‡¦ç†
              alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚');
              window.location.href = 'top.html';
          } else {
              // ã‚¨ãƒ©ãƒ¼å‡¦ç†
              alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
          }
      } catch (error) {
          // é€šä¿¡ã‚¨ãƒ©ãƒ¼ã®å‡¦ç†
          alert('é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
          console.error(error);
      }
  });
</script>

<!--æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ-->
<script>
document.addEventListener("DOMContentLoaded", function() {
  const fileList = document.getElementById("fileList");
  const addFileButton = document.getElementById("addFileButton");

  addFileButton.addEventListener("click", function() {
    const newFileName = prompt("æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:", "æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«");
    if (newFileName) {
      const newFileItem = document.createElement("li");

      const icon = document.createElement("div");
      icon.classList.add("icon");
      icon.textContent = "ğŸ“„";
      newFileItem.appendChild(icon);

      const fileInfo = document.createElement("div");
      fileInfo.classList.add("file-info");
      fileInfo.textContent = newFileName;
      newFileItem.appendChild(fileInfo);

      const deleteButton = document.createElement("button");
      deleteButton.classList.add("delete-button");
      deleteButton.textContent = "å‰Šé™¤";
      newFileItem.appendChild(deleteButton);

      newFileItem.addEventListener("click", function(event) {
        if (event.target.classList.contains("delete-button")) {
          newFileItem.remove();
          return;
        }
    
      // ãƒ•ã‚¡ã‚¤ãƒ«é …ç›®ã«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
      newFileItem.addEventListener("click", function() {
      const targetFilePath = "monolis.html"; // è‡ªä½œã—ãŸãƒšãƒ¼ã‚¸ã®ç›¸å¯¾ãƒ‘ã‚¹
      const urlWithParameter = `${targetFilePath}?filename=${encodeURIComponent(newFileName)}`;
      window.location.href = urlWithParameter;
      });
      });

      fileList.appendChild(newFileItem);
    }
 }) ;
});
</script>
</body>
</html>
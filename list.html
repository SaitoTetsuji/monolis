<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://monolis.f5.si/js/api_access.js"></script>
<link rel="stylesheet" href="list.css">
<title>MONOLIS</title>



</head>
<body>
<h1>ファイル一覧</h1>
<ul id="fileList">

</ul>
<button id="addFileButton">＋ 新規ファイル追加</button>

<!--ユーザー情報の削除-->
<div class="deleteUser">
  <p id="deleteUser">アカウントの削除を行う</p>
</div>

<script>
  const api = new MonolisAPI("monolis.f5.si/api");
  const deleteUser = document.getElementById('deleteUser');
  
            
  deleteUser.addEventListener('click', async () => {
    const confirmed = confirm('本当にアカウント情報を削除してもよろしいですか？');
    if (confirmed) { 
    try {
        const res = await api.logout();

        if (res.status === 200) {
                        // 成功の処理
                        alert('アカウント情報を削除しました。');
                        window.location.href = 'top.html';
                    } else if (res.status === 404) {
                        // ユーザーが見つからない場合の処理
                        alert('ユーザーが見つかりません。');
                    } else {
                        // その他のエラー処理
                        alert('エラーが発生しました。もう一度お試しください。');
                    }
                } catch (error) {
                    // 通信エラーの処理
                    alert('通信エラーが発生しました。もう一度お試しください。');
                    console.error(error);
                }
}});
</script>


<!--ログアウトの操作-->
<div class="logout">
  <button id="logoutButton">ログアウト</button>
</div>

<script>
  const logoutButton = document.getElementById('logoutButton');

  logoutButton.addEventListener('click', async () => {
      try {
          const res = await api.logout();

          if (res.status === 200) {
              // 成功の処理
              alert('ログアウトしました。');
              window.location.href = 'top.html';
          } else {
              // エラー処理
              alert('ログアウト時にエラーが発生しました。もう一度お試しください。');
          }
      } catch (error) {
          // 通信エラーの処理
          alert('通信エラーが発生しました。もう一度お試しください。');
          console.error(error);
      }
  });
</script>

<!--新規ファイルの作成-->
<script>
document.addEventListener("DOMContentLoaded", function() {
  const fileList = document.getElementById("fileList");
  const addFileButton = document.getElementById("addFileButton");

  addFileButton.addEventListener("click", function() {
    const newFileName = prompt("新しいファイル名を入力してください:", "新規ファイル");
    if (newFileName) {
      const newFileItem = document.createElement("li");

      const icon = document.createElement("div");
      icon.classList.add("icon");
      icon.textContent = "📄";
      newFileItem.appendChild(icon);

      const fileInfo = document.createElement("div");
      fileInfo.classList.add("file-info");
      fileInfo.textContent = newFileName;
      newFileItem.appendChild(fileInfo);

      const deleteButton = document.createElement("button");
      deleteButton.classList.add("delete-button");
      deleteButton.textContent = "削除";
      newFileItem.appendChild(deleteButton);

      newFileItem.addEventListener("click", function(event) {
        if (event.target.classList.contains("delete-button")) {
          newFileItem.remove();
          return;
        }
    
      // ファイル項目にクリックイベントを追加
      newFileItem.addEventListener("click", function() {
      const targetFilePath = "monolis.html"; // 自作したページの相対パス
      const urlWithParameter = `${targetFilePath}?filename=${encodeURIComponent(newFileName)}`;
      window.location.href = urlWithParameter;
      });
      });

      fileList.appendChild(newFileItem);
    }
 }) ;
});
</script>
</body>
</html>